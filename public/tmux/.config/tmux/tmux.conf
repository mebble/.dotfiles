# Setup:
# https://www.youtube.com/watch?v=DzNmUNvnB04
# https://www.youtube.com/watch?v=-B5VDp50daI

set -g mouse on

# Reset prefix
# Note: C-Space may be overridden by mac os to "Select the previous input source".
# Fix: Settings > Keyboard shortcuts > Input sources > Uncheck "Select the previous input source" and/or remap it
# Ref: https://mattkirwancom.wordpress.com/2020/04/30/use-ctrl-space-tmux-prefix-keybind-macos/
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# Set 1-based index
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# use zsh
# https://superuser.com/questions/253786/how-can-i-make-tmux-use-my-default-shell
set-option -g default-shell /bin/zsh
set-option -g default-command "reattach-to-user-namespace -l zsh"

# https://www.rushiagr.com/blog/2016/06/16/everything-you-need-to-know-about-tmux-copy-pasting-ubuntu/
# https://gist.github.com/MohamedAlaa/2961058
setw -g mode-keys vi
bind P paste-buffer
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection
set -g @plugin 'tmux-plugins/tmux-yank'

# Stay in copy mode even after making a selection
set -g @yank_action 'copy-pipe'

# Remap pane bindings and open panes and windows in cwd
bind h split-window -v -c "#{pane_current_path}"
bind v split-window -h -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# List of plugins
# https://github.com/tmux-plugins/tpm/issues/230
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @continuum-restore 'on'
set -g @plugin 'MunifTanjim/tmux-mode-indicator'
set -g @mode_indicator_empty_mode_style 'bg=#c4a7e7,fg=black'
set -g @mode_indicator_prefix_mode_style 'bg=#eb6f92,fg=black'

# Other examples:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'github_username/plugin_name#branch'
# set -g @plugin 'git@github.com:user/plugin'
# set -g @plugin 'git@bitbucket.com:user/plugin'

# ============================================================================
# Color Palette - Rose Pine Moon
# ============================================================================
rose_base="#232136"       # Background
rose_surface="#2a273f"    # Slightly lighter background
rose_overlay="#393552"    # Overlays
rose_muted="#6e6a86"      # Muted text
rose_subtle="#908caa"     # Subtle text
rose_text="#e0def4"       # Main text
rose_love="#eb6f92"       # Love (pink)
rose_gold="#f6c177"       # Gold (orange)
rose_rose="#ea9a97"       # Rose (reddish)
rose_pine="#3e8fb0"       # Pine (dark teal)
rose_foam="#9ccfd8"       # Foam (light teal)
rose_iris="#c4a7e7"       # Iris (purple)
gray_dark="#3b4252"
green_soft="#a3be8c"

# ============================================================================
# State Colors
# ============================================================================
active_window_fg="${rose_gold}"
inactive_window_fg="${rose_subtle}"
status_bar_bg="${rose_base}"
status_bar_fg="${rose_foam}"
session_fg="${rose_iris}"

# Alternative inactive window colors (commented):
# inactive_window_fg="${rose_rose}"    # reddish
# inactive_window_fg="#7eb8c8"         # slightly darker foam (teal)
# inactive_window_fg="#6eb5c0"         # medium teal

# Reference:
# https://www.youtube.com/watch?v=6Jgl5wphD00
# ============================================================================
# Window Status Formats
# ============================================================================
set -g window-status-current-format "#[fg=${active_window_fg},bold] 󰧞 #[underscore]#I:#W"
set -g window-status-format "#[fg=${inactive_window_fg}] 󰧞 #I:#W"
set -g window-status-separator ""

# ============================================================================
# Pane Colours
# ============================================================================
set -g pane-border-style "fg=${gray_dark}"
set -g pane-active-border-style "fg=${green_soft}"

# ============================================================================
# Status Bar Configuration
# ============================================================================
set -g status-style "fg=${status_bar_fg},bg=${status_bar_bg}"
set -g status-left " #[fg=${session_fg},bold]󱂬 #S#[fg=${status_bar_fg},nobold] ❯"
set -g status-left-length 100
set -g status-right "#[fg=${status_bar_fg}]#{b:pane_current_path} #{tmux_mode_indicator}"
set -g status-right-length 100
set -g status-position bottom

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
